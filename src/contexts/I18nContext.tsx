'use client'

import React, {
  createContext,
  useContext,
  useState,
  useEffect,
  useCallback,
  ReactNode,
} from 'react'

export type Language = 'en' | 'hi' | 'ta' | 'bn'

export const languageNames: Record<Language, string> = {
  en: 'English',
  hi: 'हिन्दी',
  ta: 'தமிழ்',
  bn: 'বাংলা',
}

const translations = {
  en: {
    home: 'Home',
    courses: 'Courses',
    aboutUs: 'About Us',
    contact: 'Contact',
    login: 'Login',
    signUp: 'Sign Up',
    bookDemo: 'Book FREE Demo Class',
    seeSuccessStories: 'See Success Stories',
    heroTitle: 'Best NEET Biology Coaching',
    heroSubtitle: 'Delhi NCR & Pan-India Online',
    locations: 'Laxmi Nagar • Dwarka • Noida • Gurgaon • Kota • Hyderabad • Bangalore',
    topperHighlight: 'Sadhna Scored 695 (100 Percentile)',
    stats: '98% Success Rate • 2,500+ Students • AIIMS Trained Faculties',
    sadhnasScore: "Sadhna's Score",
    percentile100: '100 Percentile',
    successRate: 'Success Rate',
    neetQualified: 'NEET Qualified',
    students: 'Students',
    andCounting: '& Counting',
    nextBatchStarting: 'Next Batch Starting',
    onlySeatsLeft: 'Only 50 Seats Left',
    earlyBirdDiscount: 'Join in the next {days} days and get 15% early bird discount',
    years: 'Years',
    topScore: 'Top Score',
    whyChooseUs: 'Why Choose Us',
    ourCourses: 'Our Courses',
    testimonials: 'Testimonials',
    faculty: 'Our Faculty',
    faq: 'FAQs',
    pricing: 'Pricing',
    freeResources: 'Free Resources',
    blog: 'Blog',
    chooseLanguage: 'Choose your language',
    quickLinks: 'Quick Links',
    resources: 'Resources',
    support: 'Support',
    followUs: 'Follow Us',
    newsletter: 'Newsletter',
    enterEmail: 'Enter your email',
    subscribe: 'Subscribe',
    allRightsReserved: 'All rights reserved',
    privacyPolicy: 'Privacy Policy',
    termsOfService: 'Terms of Service',
    refundPolicy: 'Refund Policy',
    demoClasses: 'Demo Classes',
    studyMaterial: 'Study Material',
    mockTests: 'Mock Tests',
    doubtResolution: 'Doubt Resolution',
    admissionHelp: 'Admission Help',
    feeStructure: 'Fee Structure',
    downloadBrochure: 'Download Brochure',
    callUs: 'Call Us',
    emailUs: 'Email Us',
    address: 'Address',
    startFreeTrial: 'Start Free Trial',
    viewAllCourses: 'View All Courses',
    learnMore: 'Learn More',
    enrollNow: 'Enroll Now',
    getStarted: 'Get Started',
    results: 'Results',
    successStories: 'Success Stories',
    aiims: 'AIIMS',
    trainedFaculty: 'Trained Faculty',
    batchSize: 'Batch Size',
    onlineClasses: 'Online Classes',
    offlineClasses: 'Offline Classes',
    liveClasses: 'Live Classes',
    recordedClasses: 'Recorded Classes',
    personalMentorship: 'Personal Mentorship',
    weeklyTests: 'Weekly Tests',
    comprehensiveStudyMaterial: 'Comprehensive Study Material',
    regularAssessment: 'Regular Assessment',
    parentCommunication: 'Parent Communication',
    performanceTracking: 'Performance Tracking',
    expertFaculty: 'Expert Faculty',
    provenResults: 'Proven Results',
    smallBatches: 'Small Batches',
    personalisedAttention: 'Personalised Attention',
    getInTouch: 'Get in Touch',
    sendMessage: 'Send Message',
    yourName: 'Your Name',
    yourEmail: 'Your Email',
    yourPhone: 'Your Phone',
    yourMessage: 'Your Message',
    selectCourse: 'Select Course',
    selectClass: 'Select Class',
    class11: 'Class 11',
    class12: 'Class 12',
    dropper: 'Dropper',
    twoYearProgram: '2 Year Program',
  },
  hi: {
    home: 'होम',
    courses: 'कोर्स',
    aboutUs: 'हमारे बारे में',
    contact: 'संपर्क',
    login: 'लॉगिन',
    signUp: 'साइन अप',
    bookDemo: 'मुफ्त डेमो क्लास बुक करें',
    seeSuccessStories: 'सफलता की कहानियाँ देखें',
    heroTitle: 'सर्वश्रेष्ठ NEET बायोलॉजी कोचिंग',
    heroSubtitle: 'दिल्ली NCR और पूरे भारत में ऑनलाइन',
    locations: 'लक्ष्मी नगर • द्वारका • नोएडा • गुरुग्राम • कोटा • हैदराबाद • बैंगलोर',
    topperHighlight: 'साधना ने 695 स्कोर किया (100 परसेंटाइल)',
    stats: '98% सफलता दर • 2,500+ छात्र • AIIMS प्रशिक्षित फैकल्टी',
    sadhnasScore: 'साधना का स्कोर',
    percentile100: '100 परसेंटाइल',
    successRate: 'सफलता दर',
    neetQualified: 'NEET क्वालीफाइड',
    students: 'छात्र',
    andCounting: 'और बढ़ रहे हैं',
    nextBatchStarting: 'अगला बैच शुरू हो रहा है',
    onlySeatsLeft: 'केवल 50 सीटें बची हैं',
    earlyBirdDiscount: 'अगले {days} दिनों में जुड़ें और 15% अर्ली बर्ड डिस्काउंट पाएं',
    years: 'वर्ष',
    topScore: 'टॉप स्कोर',
    whyChooseUs: 'हमें क्यों चुनें',
    ourCourses: 'हमारे कोर्स',
    testimonials: 'प्रशंसापत्र',
    faculty: 'हमारी फैकल्टी',
    faq: 'अक्सर पूछे जाने वाले प्रश्न',
    pricing: 'मूल्य',
    freeResources: 'मुफ्त संसाधन',
    blog: 'ब्लॉग',
    chooseLanguage: 'अपनी भाषा चुनें',
    quickLinks: 'त्वरित लिंक',
    resources: 'संसाधन',
    support: 'सहायता',
    followUs: 'फॉलो करें',
    newsletter: 'न्यूज़लेटर',
    enterEmail: 'अपना ईमेल दर्ज करें',
    subscribe: 'सब्सक्राइब करें',
    allRightsReserved: 'सर्वाधिकार सुरक्षित',
    privacyPolicy: 'गोपनीयता नीति',
    termsOfService: 'सेवा की शर्तें',
    refundPolicy: 'रिफंड नीति',
    demoClasses: 'डेमो क्लासेस',
    studyMaterial: 'अध्ययन सामग्री',
    mockTests: 'मॉक टेस्ट',
    doubtResolution: 'डाउट रिजॉल्यूशन',
    admissionHelp: 'एडमिशन हेल्प',
    feeStructure: 'फीस स्ट्रक्चर',
    downloadBrochure: 'ब्रोशर डाउनलोड करें',
    callUs: 'कॉल करें',
    emailUs: 'ईमेल करें',
    address: 'पता',
    startFreeTrial: 'मुफ्त ट्रायल शुरू करें',
    viewAllCourses: 'सभी कोर्स देखें',
    learnMore: 'और जानें',
    enrollNow: 'अभी नामांकन करें',
    getStarted: 'शुरू करें',
    results: 'रिजल्ट्स',
    successStories: 'सफलता की कहानियाँ',
    aiims: 'एम्स',
    trainedFaculty: 'प्रशिक्षित फैकल्टी',
    batchSize: 'बैच साइज़',
    onlineClasses: 'ऑनलाइन क्लासेस',
    offlineClasses: 'ऑफलाइन क्लासेस',
    liveClasses: 'लाइव क्लासेस',
    recordedClasses: 'रिकॉर्डेड क्लासेस',
    personalMentorship: 'व्यक्तिगत मेंटरशिप',
    weeklyTests: 'साप्ताहिक टेस्ट',
    comprehensiveStudyMaterial: 'व्यापक अध्ययन सामग्री',
    regularAssessment: 'नियमित मूल्यांकन',
    parentCommunication: 'अभिभावक संवाद',
    performanceTracking: 'परफॉर्मेंस ट्रैकिंग',
    expertFaculty: 'विशेषज्ञ फैकल्टी',
    provenResults: 'सिद्ध परिणाम',
    smallBatches: 'छोटे बैच',
    personalisedAttention: 'व्यक्तिगत ध्यान',
    getInTouch: 'संपर्क करें',
    sendMessage: 'संदेश भेजें',
    yourName: 'आपका नाम',
    yourEmail: 'आपका ईमेल',
    yourPhone: 'आपका फोन',
    yourMessage: 'आपका संदेश',
    selectCourse: 'कोर्स चुनें',
    selectClass: 'क्लास चुनें',
    class11: 'कक्षा 11',
    class12: 'कक्षा 12',
    dropper: 'ड्रॉपर',
    twoYearProgram: '2 वर्ष कार्यक्रम',
  },
  ta: {
    home: 'முகப்பு',
    courses: 'பாடநெறிகள்',
    aboutUs: 'எங்களைப் பற்றி',
    contact: 'தொடர்பு',
    login: 'உள்நுழைவு',
    signUp: 'பதிவு செய்க',
    bookDemo: 'இலவச டெமோ வகுப்பு முன்பதிவு செய்க',
    seeSuccessStories: 'வெற்றிக் கதைகளைப் பாருங்கள்',
    heroTitle: 'சிறந்த NEET உயிரியல் பயிற்சி',
    heroSubtitle: 'டெல்லி NCR மற்றும் இந்தியா முழுவதும் ஆன்லைன்',
    locations: 'லட்சுமி நகர் • த்வாரகா • நொய்டா • குருகிராம் • கோட்டா • ஹைதராபாத் • பெங்களூர்',
    topperHighlight: 'சாதனா 695 மதிப்பெண் (100 சதவீதம்)',
    stats: '98% வெற்றி விகிதம் • 2,500+ மாணவர்கள் • AIIMS பயிற்சி பெற்ற ஆசிரியர்கள்',
    sadhnasScore: 'சாதனாவின் மதிப்பெண்',
    percentile100: '100 சதவீதம்',
    successRate: 'வெற்றி விகிதம்',
    neetQualified: 'NEET தகுதி பெற்றவர்கள்',
    students: 'மாணவர்கள்',
    andCounting: 'மற்றும் அதிகரித்து வருகிறது',
    nextBatchStarting: 'அடுத்த தொகுதி தொடங்குகிறது',
    onlySeatsLeft: '50 இடங்கள் மட்டுமே உள்ளன',
    earlyBirdDiscount: 'அடுத்த {days} நாட்களில் சேர்ந்து 15% தள்ளுபடி பெறுங்கள்',
    years: 'ஆண்டுகள்',
    topScore: 'உச்ச மதிப்பெண்',
    whyChooseUs: 'ஏன் எங்களை தேர்வு செய்ய வேண்டும்',
    ourCourses: 'எங்கள் பாடநெறிகள்',
    testimonials: 'சான்றிதழ்கள்',
    faculty: 'எங்கள் ஆசிரியர்கள்',
    faq: 'அடிக்கடி கேட்கப்படும் கேள்விகள்',
    pricing: 'விலை',
    freeResources: 'இலவச வளங்கள்',
    blog: 'வலைப்பதிவு',
    chooseLanguage: 'உங்கள் மொழியை தேர்ந்தெடுக்கவும்',
    quickLinks: 'விரைவு இணைப்புகள்',
    resources: 'வளங்கள்',
    support: 'ஆதரவு',
    followUs: 'எங்களை பின்தொடரவும்',
    newsletter: 'செய்திமடல்',
    enterEmail: 'உங்கள் மின்னஞ்சலை உள்ளிடவும்',
    subscribe: 'சந்தா செலுத்துக',
    allRightsReserved: 'அனைத்து உரிமைகளும் பாதுகாக்கப்பட்டவை',
    privacyPolicy: 'தனியுரிமைக் கொள்கை',
    termsOfService: 'சேவை விதிமுறைகள்',
    refundPolicy: 'பணத்திரும்ப கொள்கை',
    demoClasses: 'டெமோ வகுப்புகள்',
    studyMaterial: 'படிப்புப் பொருட்கள்',
    mockTests: 'மாதிரி தேர்வுகள்',
    doubtResolution: 'சந்தேக தீர்வு',
    admissionHelp: 'சேர்க்கை உதவி',
    feeStructure: 'கட்டண அமைப்பு',
    downloadBrochure: 'கையேடு பதிவிறக்கம்',
    callUs: 'அழைக்கவும்',
    emailUs: 'மின்னஞ்சல் செய்யவும்',
    address: 'முகவரி',
    startFreeTrial: 'இலவச சோதனை தொடங்கவும்',
    viewAllCourses: 'அனைத்து பாடநெறிகளையும் காண்க',
    learnMore: 'மேலும் அறிக',
    enrollNow: 'இப்போது சேரவும்',
    getStarted: 'தொடங்கவும்',
    results: 'முடிவுகள்',
    successStories: 'வெற்றிக் கதைகள்',
    aiims: 'எய்ம்ஸ்',
    trainedFaculty: 'பயிற்சி பெற்ற ஆசிரியர்கள்',
    batchSize: 'தொகுதி அளவு',
    onlineClasses: 'ஆன்லைன் வகுப்புகள்',
    offlineClasses: 'ஆஃப்லைன் வகுப்புகள்',
    liveClasses: 'நேரடி வகுப்புகள்',
    recordedClasses: 'பதிவு செய்த வகுப்புகள்',
    personalMentorship: 'தனிப்பட்ட வழிகாட்டுதல்',
    weeklyTests: 'வாராந்திர தேர்வுகள்',
    comprehensiveStudyMaterial: 'விரிவான படிப்புப் பொருட்கள்',
    regularAssessment: 'வழக்கமான மதிப்பீடு',
    parentCommunication: 'பெற்றோர் தொடர்பு',
    performanceTracking: 'செயல்திறன் கண்காணிப்பு',
    expertFaculty: 'நிபுணர் ஆசிரியர்கள்',
    provenResults: 'நிரூபிக்கப்பட்ட முடிவுகள்',
    smallBatches: 'சிறிய தொகுதிகள்',
    personalisedAttention: 'தனிப்பட்ட கவனிப்பு',
    getInTouch: 'தொடர்பு கொள்ளுங்கள்',
    sendMessage: 'செய்தி அனுப்பு',
    yourName: 'உங்கள் பெயர்',
    yourEmail: 'உங்கள் மின்னஞ்சல்',
    yourPhone: 'உங்கள் தொலைபேசி',
    yourMessage: 'உங்கள் செய்தி',
    selectCourse: 'பாடநெறி தேர்ந்தெடுக்கவும்',
    selectClass: 'வகுப்பு தேர்ந்தெடுக்கவும்',
    class11: 'வகுப்பு 11',
    class12: 'வகுப்பு 12',
    dropper: 'டிராப்பர்',
    twoYearProgram: '2 வருட திட்டம்',
  },
  bn: {
    home: 'হোম',
    courses: 'কোর্স',
    aboutUs: 'আমাদের সম্পর্কে',
    contact: 'যোগাযোগ',
    login: 'লগইন',
    signUp: 'সাইন আপ',
    bookDemo: 'বিনামূল্যে ডেমো ক্লাস বুক করুন',
    seeSuccessStories: 'সাফল্যের গল্প দেখুন',
    heroTitle: 'সেরা NEET বায়োলজি কোচিং',
    heroSubtitle: 'দিল্লি NCR এবং সারা ভারতে অনলাইন',
    locations: 'লক্ষ্মী নগর • দ্বারকা • নয়ডা • গুরুগ্রাম • কোটা • হায়দরাবাদ • ব্যাঙ্গালোর',
    topperHighlight: 'সাধনা ৬৯৫ স্কোর করেছে (১০০ পার্সেন্টাইল)',
    stats: '৯৮% সাফল্যের হার • ২,৫০০+ শিক্ষার্থী • AIIMS প্রশিক্ষিত ফ্যাকাল্টি',
    sadhnasScore: 'সাধনার স্কোর',
    percentile100: '১০০ পার্সেন্টাইল',
    successRate: 'সাফল্যের হার',
    neetQualified: 'NEET যোগ্য',
    students: 'শিক্ষার্থী',
    andCounting: 'এবং বাড়ছে',
    nextBatchStarting: 'পরবর্তী ব্যাচ শুরু হচ্ছে',
    onlySeatsLeft: 'মাত্র ৫০টি সীট বাকি',
    earlyBirdDiscount: 'পরবর্তী {days} দিনে যোগ দিন এবং ১৫% আর্লি বার্ড ডিসকাউন্ট পান',
    years: 'বছর',
    topScore: 'সর্বোচ্চ স্কোর',
    whyChooseUs: 'কেন আমাদের বেছে নেবেন',
    ourCourses: 'আমাদের কোর্স',
    testimonials: 'প্রশংসাপত্র',
    faculty: 'আমাদের ফ্যাকাল্টি',
    faq: 'সাধারণ প্রশ্নাবলী',
    pricing: 'মূল্য',
    freeResources: 'বিনামূল্যে সম্পদ',
    blog: 'ব্লগ',
    chooseLanguage: 'আপনার ভাষা নির্বাচন করুন',
    quickLinks: 'দ্রুত লিংক',
    resources: 'সম্পদ',
    support: 'সহায়তা',
    followUs: 'আমাদের অনুসরণ করুন',
    newsletter: 'নিউজলেটার',
    enterEmail: 'আপনার ইমেল লিখুন',
    subscribe: 'সাবস্ক্রাইব করুন',
    allRightsReserved: 'সর্বস্বত্ব সংরক্ষিত',
    privacyPolicy: 'গোপনীয়তা নীতি',
    termsOfService: 'সেবার শর্তাবলী',
    refundPolicy: 'ফেরত নীতি',
    demoClasses: 'ডেমো ক্লাস',
    studyMaterial: 'পড়াশোনার উপকরণ',
    mockTests: 'মক টেস্ট',
    doubtResolution: 'সন্দেহ সমাধান',
    admissionHelp: 'ভর্তি সহায়তা',
    feeStructure: 'ফি কাঠামো',
    downloadBrochure: 'ব্রোশার ডাউনলোড',
    callUs: 'কল করুন',
    emailUs: 'ইমেল করুন',
    address: 'ঠিকানা',
    startFreeTrial: 'বিনামূল্যে ট্রায়াল শুরু করুন',
    viewAllCourses: 'সব কোর্স দেখুন',
    learnMore: 'আরও জানুন',
    enrollNow: 'এখনই ভর্তি হন',
    getStarted: 'শুরু করুন',
    results: 'ফলাফল',
    successStories: 'সাফল্যের গল্প',
    aiims: 'এইমস',
    trainedFaculty: 'প্রশিক্ষিত ফ্যাকাল্টি',
    batchSize: 'ব্যাচের আকার',
    onlineClasses: 'অনলাইন ক্লাস',
    offlineClasses: 'অফলাইন ক্লাস',
    liveClasses: 'লাইভ ক্লাস',
    recordedClasses: 'রেকর্ডেড ক্লাস',
    personalMentorship: 'ব্যক্তিগত মেন্টরশিপ',
    weeklyTests: 'সাপ্তাহিক পরীক্ষা',
    comprehensiveStudyMaterial: 'বিস্তৃত পড়াশোনার উপকরণ',
    regularAssessment: 'নিয়মিত মূল্যায়ন',
    parentCommunication: 'অভিভাবক যোগাযোগ',
    performanceTracking: 'পারফরম্যান্স ট্র্যাকিং',
    expertFaculty: 'বিশেষজ্ঞ ফ্যাকাল্টি',
    provenResults: 'প্রমাণিত ফলাফল',
    smallBatches: 'ছোট ব্যাচ',
    personalisedAttention: 'ব্যক্তিগত মনোযোগ',
    getInTouch: 'যোগাযোগ করুন',
    sendMessage: 'বার্তা পাঠান',
    yourName: 'আপনার নাম',
    yourEmail: 'আপনার ইমেল',
    yourPhone: 'আপনার ফোন',
    yourMessage: 'আপনার বার্তা',
    selectCourse: 'কোর্স নির্বাচন করুন',
    selectClass: 'ক্লাস নির্বাচন করুন',
    class11: 'ক্লাস ১১',
    class12: 'ক্লাস ১২',
    dropper: 'ড্রপার',
    twoYearProgram: '২ বছরের প্রোগ্রাম',
  },
}

export type TranslationKey = keyof typeof translations.en

interface I18nContextType {
  language: Language
  setLanguage: (lang: Language) => void
  t: (key: TranslationKey, params?: Record<string, string | number>) => string
  availableLanguages: Language[]
}

const I18nContext = createContext<I18nContextType | undefined>(undefined)

function detectLanguage(): Language {
  if (typeof window === 'undefined') return 'en'

  const savedLang = localStorage.getItem('preferred-language') as Language
  if (savedLang && savedLang in translations) {
    return savedLang
  }

  const browserLang = navigator.language.toLowerCase()
  if (browserLang.includes('hi')) return 'hi'
  if (browserLang.includes('ta')) return 'ta'
  if (browserLang.includes('bn')) return 'bn'

  return 'en'
}

export function I18nProvider({ children }: { children: ReactNode }) {
  const [language, setLanguageState] = useState<Language>('en')
  const [isHydrated, setIsHydrated] = useState(false)

  useEffect(() => {
    const detected = detectLanguage()
    setLanguageState(detected)
    setIsHydrated(true)
  }, [])

  const setLanguage = useCallback((lang: Language) => {
    setLanguageState(lang)
    if (typeof window !== 'undefined') {
      localStorage.setItem('preferred-language', lang)
      document.documentElement.lang = lang
    }
  }, [])

  const t = useCallback(
    (key: TranslationKey, params?: Record<string, string | number>): string => {
      let text = translations[language]?.[key] || translations.en[key] || key
      if (params) {
        Object.entries(params).forEach(([paramKey, value]) => {
          text = text.replace(`{${paramKey}}`, String(value))
        })
      }
      return text
    },
    [language]
  )

  const value: I18nContextType = {
    language,
    setLanguage,
    t,
    availableLanguages: ['en', 'hi', 'ta', 'bn'],
  }

  if (!isHydrated) {
    return <>{children}</>
  }

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>
}

export function useI18n() {
  const context = useContext(I18nContext)
  if (context === undefined) {
    return {
      language: 'en' as Language,
      setLanguage: () => {},
      t: (key: TranslationKey) => translations.en[key] || key,
      availableLanguages: ['en', 'hi', 'ta', 'bn'] as Language[],
    }
  }
  return context
}
